"use strict";(self.webpackChunksocnet=self.webpackChunksocnet||[]).push([[233],{1233:function(e,s,a){a.r(s),a.d(s,{default:function(){return y}});var n=a(5671),r=a(3144),t=a(136),c=a(5716),o=a(2791),i=a(364),u=a(7781),l=a(3268),m=a(2982),g=a(885),d={Messages:"Messages_Messages__1EQQz",friends:"Messages_friends__nEokc",messages:"Messages_messages__ViKAd",messagesBox:"Messages_messagesBox__UwwLl",messageAvatar:"Messages_messageAvatar__pgT7y",friend:"Messages_friend__XftjX",active:"Messages_active__8HIPB",avatar:"Messages_avatar__K6DLY",name:"Messages_name__sHyXH",message:"Messages_message__LQOQA",messageBox:"Messages_messageBox__gSD3Y",messageDate:"Messages_messageDate__CpBsr",MessagesForm:"Messages_MessagesForm__zWKIY",textarea:"Messages_textarea__tglNx",btn:"Messages_btn__kwvO+",box:"Messages_box__+4OW+"},f=a(8308),h=a(3504),_=a(6139),x=a(704),p=a(9875),v=a(1153),j=a(184),M=(0,v.bq)(300),Z=(0,x.Z)({form:"messages"})((function(e){var s=e.handleSubmit;return(0,j.jsxs)("form",{className:d.MessagesForm,onSubmit:s,children:[(0,j.jsx)(_.Z,{className:d.textarea,component:p.Z,name:"message",validate:[M]}),(0,j.jsx)("button",{className:d.btn,type:"submit",children:"Send"})]})})),N=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),b=function(e){var s=(0,o.useState)([]),a=(0,g.Z)(s,2),n=a[0],r=a[1],t=(0,o.useRef)();(0,o.useEffect)((function(){N.addEventListener("message",(function(e){r((function(s){return[].concat((0,m.Z)(s),(0,m.Z)(JSON.parse(e.data)))}))}))}),[]);var c=(0,o.useCallback)((function(e){N&&N.send(e)}),[N]);return(0,o.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight+t.current.offsetHeight}),[n]),(0,o.useEffect)((function(){t&&t.current.addEventListener("scroll",(function(){console.log("scroll Top",t.current.scrollTop),console.log("scroll Height",t.current.scrollHeight),console.log("inner Height",t.current.offsetHeight)}))}),[t]),(0,j.jsxs)("div",{className:d.Messages,children:[(0,j.jsx)("ul",{className:d.friends,children:0===e.friends.length?(0,j.jsx)("p",{className:d.empty,children:"You don't have friends yet"}):e.friends.map((function(e){return(0,j.jsxs)(h.rU,{className:d.friend,to:"/profile/".concat(e.id),children:[(0,j.jsx)("img",{src:e.photos.small?e.photos.small:f,alt:"",className:d.avatar}),(0,j.jsx)("p",{className:d.name,children:e.name})]},e.id)}))}),(0,j.jsxs)("div",{className:d.messages,children:[(0,j.jsx)("div",{className:d.messagesBox,ref:t,children:n.map((function(e,s){return(0,j.jsxs)("div",{className:d.message,children:[(0,j.jsxs)("div",{className:d.messageBox,children:[(0,j.jsx)(h.rU,{to:"/profile/".concat(e.userId),children:(0,j.jsx)("img",{src:e.photo||f,className:d.messageAvatar})}),(0,j.jsx)("span",{className:d.messageDate,children:e.userId})]}),(0,j.jsx)("p",{className:d.messageText,children:e.message})]},s)}))}),(0,j.jsx)(Z,{onSubmit:function(e){return c(e.message)}})]})]})},A=a(6407),k=function(e){(0,t.Z)(a,e);var s=(0,c.Z)(a);function a(){return(0,n.Z)(this,a),s.apply(this,arguments)}return(0,r.Z)(a,[{key:"render",value:function(){return(0,j.jsx)(b,{messages:this.props.messages,friends:this.props.friends,sendMessage:this.props.sendMessage})}}]),a}(o.Component),y=(0,u.qC)(l.Z,(0,i.$j)((function(e){return{friends:e.users.friends,messages:e.profile.messages}}),{sendMessage:A.Tu}))(k)},9875:function(e,s,a){a.d(s,{Z:function(){return u}});var n=a(1413),r=a(5987),t=(a(2791),"Textarea_container__8xwgg"),c="Textarea_error__Zh8jH",o=a(184),i=["input","meta"],u=function(e){var s=e.input,a=e.meta,u=(0,r.Z)(e,i);return(0,o.jsxs)("div",{className:t,children:[a.error&&0===a.error.code&&a.touched&&!a.active&&(0,o.jsx)("p",{className:c,children:a.error.message}),a.error&&1===a.error.code&&(0,o.jsx)("p",{className:c,children:a.error.message}),a.error&&2===a.error.code&&a.touched&&!a.active&&(0,o.jsx)("p",{className:c,children:a.error.message}),(0,o.jsx)("textarea",(0,n.Z)((0,n.Z)({},s),u))]})}},3268:function(e,s,a){var n=a(5671),r=a(3144),t=a(136),c=a(5716),o=a(2791),i=a(364),u=a(6871),l=a(184);s.Z=function(e){var s=function(s){(0,t.Z)(o,s);var a=(0,c.Z)(o);function o(){return(0,n.Z)(this,o),a.apply(this,arguments)}return(0,r.Z)(o,[{key:"render",value:function(){return!1===this.props.isAuth?(0,l.jsx)(u.Fg,{to:"/login"}):(0,l.jsx)(e,{})}}]),o}(o.Component);return(0,i.$j)((function(e){return{isAuth:e.auth.isAuth}}))(s)}},1153:function(e,s,a){a.d(s,{Kb:function(){return c},Le:function(){return r},bq:function(){return t},qB:function(){return n}});var n=function(e){if("string"===typeof e)return/[a-zA-Z1-9]/.test(e)||0===e.length},r=function(e){if(!e||!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e))return{code:4,message:"Invalid email address"}},t=function(e){return function(s){return s?s&&s.length>e?{code:1,message:"Max length: ".concat(e," characters !")}:s&&!/[a-zA-Z1-9]/.test(s)?{code:2,message:"Value must contain numbers or letters !"}:void 0:{code:0,message:"Value mustn't be empty !"}}},c=function(e){return e&&e.length<4?{code:2,message:"Min length is 4 characters !"}:e&&e.length>35?{code:3,message:"Max length is 35 characters !"}:e&&!/[a-zA-Z]/.test(e)?{code:1,message:"Value must contain letters !"}:e?void 0:{code:0,message:"This field is required"}}}}]);
//# sourceMappingURL=233.11a4308a.chunk.js.map